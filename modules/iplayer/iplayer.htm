<style type="text/css">
    
.iplayer 
{
  	height:100%;
}

.iplayer .video-js 
{
	width:100% !important;
	height:100% !important;
}
    
.iplayer .titlebar {
  color: white;
  position: absolute;
  bottom: 0px;
  text-align: center;
  padding: 5px 5px 5px 10px;
  left: 0px;
  bottom: 0px;
  width: 100%;
  background: rgba(18, 51, 92, 0.7);
}

.iplayer .titlebar a {
  color: white; 
}
.iplayer .titlebar a :hover {
    color: red; 
}
.iplayer .playbutton {
	text-align: center;
    margin-top: 25%;
}
</style>
<!-- BEGIN IPLAYER -->
<div class="iplayer" id="iplayer$mid">
<div class="iplayerVideoplay hidden">
<video id='videoPlayer$mid' style='background:#000;' class='video-js vjs-default-skin vjs-big-play-centered videoplayer' 
    src='' controls width='100%' height='100%' autoplay> 
    <source src='#' type='#'> 
</video>
</div>

<!-- BEGIN WIDGET GRADIENT -->
<div id="iplayerCarousel$mid" class="carousel slide widget-carousel  " data-ride="carousel">
  <!-- Indicators -->
  <ol class="carousel-indicators">
  <!--# for($i=0; $i<$nr_item; $i++) { $active = $udb[$i]['active']; #-->
      <li data-target="#iplayerCarousel$mid" data-slide-to="$i" class="circle $active"></li>
  <!--# } #-->  
  </ol>
  <!-- Wrapper for slides -->
  <div class="carousel-inner" role="listbox">
  <!--# $i = 0; foreach($udb as $key=>$v) { $active = ($i++ == 0)?'active':'';  $resize = $v['photo']; //$width, $iheight); #-->
      <div class="item $active">
          <div class="widget-gradient" style="background-image: url('$resize')">
              <div class="widget-gradient-body">
                  
                  <ul class="widget-gradient-body-actions list-inline">
                      <!--<li>
                          <a href="#">
                              <i class="fa fa-heart"></i> 12 </a>
                      </li>
                      <li>
                          <a href="#">
                              <i class="fa fa-comment"></i> 9 </a>
                      </li>-->

                  </ul>
                  <!--# if ($v['video']) { #-->
                  <div class="playbutton">
                    <a href='$v[video]'  class="btn default videoplay" data-playurl="$v[video]"><i class="fa fa-play"> </i></a>                   
                  </div>
                  <!--# } #-->
              </div>
              <div class="titlebar">
                <h4 class="widget-gradient-title"><a href='$v[url]'>$v[name]</a></h4>
              </div>
          </div>
          
      </div>
<!--# } #-->      
  </div>
  
  <!--# if ($i > 0) { #-->
    <a class="left carousel-control" href="#iplayerCarousel$mid" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    
    <a class="right carousel-control" href="#iplayerCarousel$mid" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a>
    <!--# } #-->
</div>
<!-- END WIDGET GRADIENT -->
</div>
<!-- END IPLAYER -->

<script type="text/javascript">
    jQuery(document).ready(function() {
        var vplayer = null;
        var iplayer = $('#iplayer$mid');
        var wg = $('.widget-gradient', iplayer);
        var iplayerVideoplay = $('.iplayerVideoplay', iplayer);
        var iplayerCarousel = $('.carousel', iplayer);

        $(window).resize(function() {
            var i_width = iplayer.width();
            var i_height = Math.round(i_width*0.618)+30;//»Æ½ð·Ö¸ô
            wg.height(i_height);
            //console.log('i_height='+i_height);
            //console.log('iplayerCarousel height='+iplayerCarousel.height());
            iplayerVideoplay.height(i_height);

        }).resize();

        //iplayer parent
        var iplayerParent = iplayer.closest('.row');
        
        $('.videoplay', iplayerParent).on('click', function(e) {
            e.preventDefault();
            
            iplayerVideoplay.removeClass('hidden');
            iplayerCarousel.addClass('hidden');

            var url = $(this).attr('data-playurl');
            var videotype = 'video/mp4';
            var isHLS = false;
            if (/\.m3u8$/.test(url)) {
                videotype = 'application/x-mpegURL';
                isHLS = true;
            }

            //check iplayer
            var vd = $('.videoplayer', iplayer);

            vplayer = videojs('videoPlayer$mid');
            if (isHLS) {
                vplayer.src({src:url, type:videotype});
            } else {
                vplayer.src({src:url, type:"video/mp4"});
                vplayer.src(url);
            }
            vplayer.load();
            vplayer.play();                 
   
        });
    });
</script>